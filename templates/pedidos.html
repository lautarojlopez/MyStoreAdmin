{% extends "layout.html" %}
{% block content %}
<h2 class="text-center p-5 text-white text-3xl bg-green-500">Pedidos</h2>

{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
    <div class="m-auto mt-3 w-11/12 md:w-8/12 lg:w-6/12 xl:w-4/12">
        <ul class='text-center'>
            {% for categoria, message in messages %}
                {% if categoria == 'error' %}
                <li class="p-3 mb-2 rounded-lg border-2 border-red-500 text-red-700 bg-red-200">{{ message }}</li>
                {% endif %}
                {% if categoria == 'success' %}
                <li class="p-3 mb-2 rounded-lg border-2 border-green-500 text-green-700 bg-green-200">{{ message }}</li>
                {% endif %}
            {% endfor %}
        </ul>
    </div>
{% endif %}
{% endwith %}

<div class="p-8">
{% if pedidos|length > 0 %}
    {% for pedido in pedidos %}
        <div class="mt-3 p-4 w-full border border-green-600 rounded-lg shadow-lg">
            <div class="">
                <div class="flex flex-col">
                    <p class="text-green-500 font-bold">Cliente</p>
                    <p>{{ pedido.cliente.nombre }} - ({{ pedido.cliente.email }})</p>
                    <p class="text-green-500 font-bold">Fecha</p>
                    <p id="fecha">{{ pedido.created_at }}</p>
                    <div class="grid grid-cols-2 w-8/12">
                        <div>
                            <p class="text-green-500 font-bold">Productos</p>
                            {% for producto in pedido.productos %}
                                {% if producto.nombre %}
                                  <p>{{ producto.nombre }} ({{ producto.codigo }})</p>
                                {% else %}
                                  <p class="italic text-gray-400">Producto eliminado</p>
                                {% endif %} 
                            {% endfor %}
                        </div>
                        <div>
                            <p class="text-green-500 font-bold">Cantidad</p>
                            {% for cantidad in pedido.cantidades %}
                                <p>{{ cantidad }}</p>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
{% else %}
    <p class="text-center text-xl">Aún no has añadido pedidos.</p>
{% endif %}

</div>

{% endblock content %}